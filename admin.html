<div class="admin-card p-8 w-full max-w-5xl mx-auto mt-8">
        <h2 class="text-2xl font-bold mb-6 text-gray-800">2. Manual Key Generation</h2>
        <form id="keyForm" class="space-y-4">
            <div>
                <label for="keyUserEmail" class="block text-sm font-medium text-gray-700">Target User Email (Optional)</label>
                <input type="email" id="keyUserEmail" class="mt-1 block w-full p-2 border border-gray-300 rounded-md" placeholder="Supabase User Email atau biarkan kosong">
            </div>
            <div>
                <label for="customKeyValue" class="block text-sm font-medium text-gray-700">Custom Key Value (Optional)</label>
                <input type="text" id="customKeyValue" class="mt-1 block w-full p-2 border border-gray-300 rounded-md" placeholder="e.g., ADMIN-SUPER-KEY">
            </div>
            <div>
                <label for="keyDuration" class="block text-sm font-medium text-gray-700">Duration (in seconds)</label>
                <input type="number" id="keyDuration" class="mt-1 block w-full p-2 border border-gray-300 rounded-md" placeholder="e.g., 86400 for 1 day. Use 0 for unlimited." required>
            </div>
            <button type="submit" class="w-full bg-green-600 text-white font-semibold py-2 px-4 rounded-lg hover:bg-green-700">
                Generate Key
            </button>
        </form>
        <p id="keyMessage" class="mt-4 text-center text-sm"></p>
    </div>
    
// Key Generation Logic (Manual Admin Key)
        document.getElementById('keyForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const keyMessage = document.getElementById('keyMessage');
            
            keyMessage.textContent = 'Generating key...';
            const response = await fetch('/.netlify/functions/admin-generate-key', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    duration: parseInt(document.getElementById('keyDuration').value, 10),
                    // PERUBAHAN: Mengirim user_email dan custom_key
                    user_email: document.getElementById('keyUserEmail').value || null, 
                    custom_key: document.getElementById('customKeyValue').value || null
                })
            });
            const result = await response.json();
            if (response.ok) {
                keyMessage.textContent = `Key generated: ${result.key}`;
                keyMessage.className = 'mt-4 text-center text-sm text-green-600';
                e.target.reset();
                fetchAdminKeys();
            } else {
                keyMessage.textContent = `Error: ${result.error}`;
                keyMessage.className = 'mt-t-4 text-center text-sm text-red-600';
            }
        });