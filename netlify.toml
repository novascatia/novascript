[functions]
  directory = "netlify/functions"

# ==================================
# PUBLIC PAGES & AUTH
# ==================================
[[redirects]]
  from = "/"
  to = "/index.html"
  status = 200
  
[[redirects]]
  from = "/dashboard"
  to = "/dashboard.html"
  status = 200
  
[[redirects]]
  from = "/purchase"
  to = "/purchase.html"
  status = 200

# ==================================
# ADMIN MANAGEMENT (Protected by Credentials/Cookie)
# ==================================
[[redirects]]
  from = "/login-admin"
  to = "/login-admin.html"
  status = 200

[[redirects]]
  from = "/admin"
  to = "/admin.html"
  status = 200
  # Di implementasi nyata, ini dilindungi oleh Netlify Identity, 
  # tetapi kita menggunakan redirect dengan cek cookie di frontend.

# Netlify Functions untuk Admin Login
[[redirects]]
  from = "/.netlify/functions/check-credentials"
  to = "/.netlify/functions/check-credentials"
  status = 200

[[redirects]]
  from = "/.netlify/functions/admin-generate-key"
  to = "/.netlify/functions/admin-generate-key"
  status = 200

# ==================================
# CORE FUNCTIONS (Supabase/Scripts)
# ==================================
[[redirects]]
  from = "/.netlify/functions/get-config"
  to = "/.netlify/functions/get-config"
  status = 200

[[redirects]]
  from = "/.netlify/functions/fetch-scripts-metadata"
  to = "/.netlify/functions/fetch-scripts-metadata"
  status = 200

[[redirects]]
  from = "/.netlify/functions/create-script-metadata"
  to = "/.netlify/functions/create-script-metadata"
  status = 200

# Key/Script API untuk klien Lua/Software
[[redirects]]
  from = "/.netlify/functions/verify-key"
  to = "/.netlify/functions/verify-key"
  status = 200

[[redirects]]
  from = "/.netlify/functions/download-script"
  to = "/.netlify/functions/download-script"
  status = 200

# ==================================
# QRIS PAYMENT SYSTEM
# ==================================
[[redirects]]
  from = "/.netlify/functions/create-qris-transaction"
  to = "/.netlify/functions/create-qris-transaction"
  status = 200

[[redirects]]
  from = "/.netlify/functions/check-payment-status"
  to = "/.netlify/functions/check-payment-status"
  status = 200

[[redirects]]
  from = "/.netlify/functions/qris-webhook"
  to = "/.netlify/functions/qris-webhook"
  status = 200
